"use strict";
const vm = require("vm");
/**
 * 解析jsonp
 * @param jsonp jsonp数据
 * @param callback jsonp指定的回调函数名称
 */
function parse(jsonp, callback) {
    const ctx = {
        result: undefined,
        [callback]: function (data) {
            ctx.result = data;
        }
    };
    vm.runInNewContext(jsonp, ctx);
    return ctx.result;
}
/**
 * 将数据序列化成jsonp格式
 * @param data 要序列化的数据
 * @param callback 回调函数的名称，默认为随机数
 */
function stringify(data, callback = `_${(Math.random() * 10000000000).toFixed(0)}`) {
    return `${callback}(${JSON.stringify(data)})`;
}
module.exports = { parse, stringify };

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSx5QkFBeUI7QUFFekI7Ozs7R0FJRztBQUNILGVBQWtCLEtBQWEsRUFBRSxRQUFnQjtJQUM3QyxNQUFNLEdBQUcsR0FBRztRQUNSLE1BQU0sRUFBRSxTQUFnQjtRQUN4QixDQUFDLFFBQVEsQ0FBQyxFQUFFLFVBQVUsSUFBTztZQUN6QixHQUFHLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUN0QixDQUFDO0tBQ0osQ0FBQztJQUVGLEVBQUUsQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBRS9CLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDO0FBQ3RCLENBQUM7QUFFRDs7OztHQUlHO0FBQ0gsbUJBQW1CLElBQVMsRUFBRSxXQUFtQixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRTtJQUMzRixNQUFNLENBQUMsR0FBRyxRQUFRLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO0FBQ2xELENBQUM7QUFFRCxpQkFBUyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsQ0FBQyIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHZtIGZyb20gJ3ZtJztcclxuXHJcbi8qKlxyXG4gKiDop6PmnpBqc29ucFxyXG4gKiBAcGFyYW0ganNvbnAganNvbnDmlbDmja5cclxuICogQHBhcmFtIGNhbGxiYWNrIGpzb25w5oyH5a6a55qE5Zue6LCD5Ye95pWw5ZCN56ewXHJcbiAqL1xyXG5mdW5jdGlvbiBwYXJzZTxUPihqc29ucDogc3RyaW5nLCBjYWxsYmFjazogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBjdHggPSB7XHJcbiAgICAgICAgcmVzdWx0OiB1bmRlZmluZWQgYXMgYW55LFxyXG4gICAgICAgIFtjYWxsYmFja106IGZ1bmN0aW9uIChkYXRhOiBUKSB7XHJcbiAgICAgICAgICAgIGN0eC5yZXN1bHQgPSBkYXRhO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdm0ucnVuSW5OZXdDb250ZXh0KGpzb25wLCBjdHgpO1xyXG5cclxuICAgIHJldHVybiBjdHgucmVzdWx0O1xyXG59XHJcblxyXG4vKipcclxuICog5bCG5pWw5o2u5bqP5YiX5YyW5oiQanNvbnDmoLzlvI9cclxuICogQHBhcmFtIGRhdGEg6KaB5bqP5YiX5YyW55qE5pWw5o2uXHJcbiAqIEBwYXJhbSBjYWxsYmFjayDlm57osIPlh73mlbDnmoTlkI3np7DvvIzpu5jorqTkuLrpmo/mnLrmlbBcclxuICovXHJcbmZ1bmN0aW9uIHN0cmluZ2lmeShkYXRhOiBhbnksIGNhbGxiYWNrOiBzdHJpbmcgPSBgXyR7KE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMDAwMCkudG9GaXhlZCgwKX1gKSB7XHJcbiAgICByZXR1cm4gYCR7Y2FsbGJhY2t9KCR7SlNPTi5zdHJpbmdpZnkoZGF0YSl9KWA7XHJcbn1cclxuXHJcbmV4cG9ydCA9IHsgcGFyc2UsIHN0cmluZ2lmeSB9OyJdfQ==
